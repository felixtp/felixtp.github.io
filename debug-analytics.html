<!DOCTYPE html>
<html>
<head>
    <title>Debug Analytics</title>
</head>
<body>
    <h1>Analytics Debug</h1>
    <div id="debug-output"></div>
    
    <script>
        // Debug localStorage
        const storageKey = 'vintage-blog-analytics';
        const data = localStorage.getItem(storageKey);
        
        const output = document.getElementById('debug-output');
        
        if (data) {
            const analytics = JSON.parse(data);
            output.innerHTML = `
                <h2>Raw Analytics Data:</h2>
                <pre>${JSON.stringify(analytics, null, 2)}</pre>
                
                <h2>Summary:</h2>
                <ul>
                    <li>Total Sessions: ${analytics.sessions ? analytics.sessions.length : 0}</li>
                    <li>Total Views: ${analytics.totalViews || 0}</li>
                    <li>Total Visitors: ${analytics.totalVisitors || 0}</li>
                    <li>Countries: ${analytics.countries ? Object.keys(analytics.countries).length : 0}</li>
                </ul>
                
                <h2>Recent Sessions:</h2>
                <pre>${JSON.stringify(analytics.sessions ? analytics.sessions.slice(-5) : [], null, 2)}</pre>
                
                <h2>Countries Data:</h2>
                <pre>${JSON.stringify(analytics.countries || {}, null, 2)}</pre>
            `;
        } else {
            output.innerHTML = '<p>No analytics data found in localStorage</p>';
        }
        
        // Test geolocation API
        async function testGeolocation() {
            try {
                console.log('Testing ipapi.co...');
                const response = await fetch('https://ipapi.co/json/');
                const data = await response.json();
                console.log('ipapi.co response:', data);
                
                console.log('Testing ipinfo.io...');
                const response2 = await fetch('https://ipinfo.io/json');
                const data2 = await response2.json();
                console.log('ipinfo.io response:', data2);
            } catch (error) {
                console.error('Geolocation test failed:', error);
            }
        }
        
        testGeolocation();
    </script>
</body>
</html>
